/*
Ê¥ªÂä®ÂêçÁß∞ÔºöÂ∫óÈì∫ÊäΩÂ•ñ ¬∑ Ë∂ÖÁ∫ßÊó†Á∫ø/Ë∂ÖÁ∫ß‰ºöÂëò
Ê¥ªÂä®ÈìæÊé•Ôºöhttps://lzkj-isv.isvjd.com/lzclient/<Ê¥ªÂä®id>/cjwx/common/entry.html?activityId=<Ê¥ªÂä®id>&gameType=<Áé©Ê≥ïÁ±ªÂûã>
         https://lzkj-isv.isvjd.com/wxDrawActivity/activity/activity?activityId=<Ê¥ªÂä®id>
         https://cjhy-isv.isvjcloud.com/wxDrawActivity/activity/activity?activityId=<Ê¥ªÂä®id>
ÁéØÂ¢ÉÂèòÈáèÔºöLUCK_DRAW_URL // Ê¥ªÂä®ÈìæÊé•
         LUCK_DRAW_NOTIFY // ÊòØÂê¶Êé®ÈÄÅÈÄöÁü•Ôºàtrue/falseÔºâÔºåÈªòËÆ§‰∏çÊé®ÈÄÅ
         LUCK_DRAW_OPENCARD // ÊòØÂê¶ÂÖ•‰ºöÔºàtrue/falseÔºâÔºåÈªòËÆ§‰∏çÂÖ•‰ºö
		 LUCK_DRAW_BREAK // 493ÂêéÁªßÁª≠ÊâßË°åÔºåÈªòËÆ§ÈÄÄÂá∫ËøêË°åÔºàtrue/falseÔºâ
         LUCK_DRAW_INTERVAL // Ëá™ÂÆö‰πâÊäΩÂ•ñÈó¥ÈöîÔºàÊ≠£Êï¥Êï∞ÔºâÔºåÈªòËÆ§1Áßí
         LUCK_DRAW_CONC // ÊòØÂê¶ÂêØÁî®Âπ∂ÂèëÊ®°ÂºèÔºàtrue/falseÔºâÔºåÈªòËÆ§‰∏çÂºÄÂêØ
         LUCK_DRAW_CONC_THREADS // ÊéßÂà∂Âπ∂ÂèëÁ∫øÁ®ãÊï∞ÔºàÊ≠£Êï¥Êï∞ÔºâÔºåÈªòËÆ§3         
         LUCK_DRAW_MAX_MISS // ÊúÄÂ§ßËøûÁª≠Êú™ÊäΩ‰∏≠Ê¨°Êï∞ÔºàÊ≠£Êï¥Êï∞ÔºâÔºåËææÂà∞Ê≠§Ê¨°Êï∞Âêé‰ºöË∑≥ËøáËøêË°åÂØπÂ∫îË¥¶Âè∑ÔºåÈªòËÆ§‰∏çÂêØÁî®Ê≠§ÂäüËÉΩ
		 LUCK_DRAW_CONC_RETRY // Âπ∂ÂèëÊ®°Âºè‰∏ãÊé•Âè£ËØ∑Ê±ÇÁöÑÊúÄÂ§ßÈáçËØïÊ¨°Êï∞ÔºàÊ≠£Êï¥Êï∞ÔºâÔºåÈªòËÆ§0Âç≥‰∏çÈáçËØï
		 LUCK_DRAW_NUM //ËøêË°åË¥¶Âè∑Êï∞ÈáèÔºåÈªòËÆ§ËøêË°åÂâç7
		 LUCK_DRAW_Number // ËøûÁª≠Êó†Ê¨°Êï∞Ë∑≥Âá∫ÔºåÈªòËÆ§ 7 Ê¨°ÔºåÁÅ´ÁàÜË¥¶Âè∑ËØ∑ËÆæÁΩÆÈªëÂêçÂçïÔºåÂê¶Âàô‰πü‰ºöÂç†Áî®Ê¨°Êï∞
		 LUCK_DRAW_BLACKLIST ÈªëÂêçÂçï Áî®&ÈöîÂºÄ pinÂÄº
         JD_LZ_OPEN // ÊòØÂê¶ÂºÄÂêØLZÊ¥ªÂä®ËøêË°åÔºàtrue/falseÔºâÔºåÈªòËÆ§ËøêË°å
         JD_CJ_OPEN // ÊòØÂê¶ÂºÄÂêØCJÊ¥ªÂä®ËøêË°åÔºàtrue/falseÔºâÔºåÈªòËÆ§ËøêË°å

Ê≥®ÔºöÂè™ÊúâÂú®Ê≤°ÊúâÊäΩÂ•ñÊ¨°Êï∞ÁöÑÊÉÖÂÜµ‰∏ãÊâç‰ºöÂéªÂÅö‰ªªÂä°Ëé∑ÂèñÔºåÈÉ®ÂàÜÊ¥ªÂä®Ê∂âÂèäÂÆöÂà∂Êé•Âè£‰ºöÂØºËá¥ËØ∑Ê±ÇÂìçÂ∫îÈùûÊ≥ïÊìç‰Ωú

2023/9/6 ‰øÆÂ§ç 500ÈîôËØØ ‰øÆÂ§çÈªëÂêçÂçïÊó†Êïà

cron:1 1 1 1 *
============Quantumultx===============
[task_local]
#Â∫óÈì∫ÊäΩÂ•ñÈÄöÁî®Ê¥ªÂä®-Âä†ÂØÜ
1 1 1 1 * jd_luck_draw.js, tag=Â∫óÈì∫ÊäΩÂ•ñÈÄöÁî®Ê¥ªÂä®-Âä†ÂØÜ, enabled=true

*/

const Env=require('./utils/Env.js');
const $ = new Env('Â∫óÈì∫ÊäΩÂ•ñÔºàË∂ÖÁ∫ßÊó†Á∫ø/Ë∂ÖÁ∫ß‰ºöÂëòÔºâ');

const IIi1II = $.isNode() ? require("./jdCookie") : "",
  li1lIl = require("./function/jdCommon"),
  li1lIi = require("./function/sendJDNotify"),
  IiIIil = require("./function/krgetToken"),
  {
    wuxian_savePrize: iilill
  } = require("./function/krsavePrize"),
  IiIIii = require("crypto-js");
let lIiili = [];
const lIiill = process.env.LUCK_DRAW_URL || "",
  iilili = process.env.LUCK_DRAW_OPENCARD === "true",
  Il1lIi = process.env.LUCK_DRAW_NOTIFY === "true",
  l1IIIi = process.env.LUCK_DRAW_BREAK === "true",
  i111i1 = process.env.LUCK_DRAW_CONC === "true",
  l1IlI = process.env.LUCK_DRAW_CONC_THREADS || "3";
let l1IIIl = process.env.LUCK_DRAW_CONC_RETRY || "0";
const IiliI1 = process.env.LUCK_DRAW_INTERVAL || "";
let Iiii11 = process.env.LUCK_DRAW_MAX_MISS || "",
  l11I = 7;
process.env.LUCK_DRAW_NUM && process.env.LUCK_DRAW_NUM != 7 && (l11I = process.env.LUCK_DRAW_NUM);
let llllli = true,
  iiiii1 = process.env.LUCK_DRAW_Number ? process.env.LUCK_DRAW_Number : "11",
  IIill1 = process.env.JD_LZ_OPEN ? process.env.JD_LZ_OPEN : "true",
  iIII = process.env.JD_CJ_OPEN ? process.env.JD_CJ_OPEN : "true",
  iI1I1 = "",
  Ii11iI = "",
  IiliII = "";
if ($.isNode()) {
  if (JSON.stringify(process.env).indexOf("GITHUB") > -1) {
    process.exit(0);
  }
  Object.keys(IIi1II).forEach(l1Ili => {
    lIiili.push(IIi1II[l1Ili]);
  });
  if (process.env.JD_DEBUG && process.env.JD_DEBUG === "false") {
    console.log = () => {};
  }
} else {
  lIiili = [$.getdata("CookieJD"), $.getdata("CookieJD2"), ...$.toObj($.getdata("CookiesJD") || "[]").map(i1II11 => i1II11.cookie)].filter(l1Ill => !!l1Ill);
}
!lIiili[0] && ($.msg($.name, "„ÄêÊèêÁ§∫„ÄëËØ∑ÂÖàËé∑ÂèñCookie"), process.exit(1));
let Iiii1I = "",
  II1il1 = "";
$.whitelist = process.env.LUCK_DRAW_WHITELIST || Iiii1I;
$.blacklist = process.env.LUCK_DRAW_BLACKLIST || II1il1;
IIillI();
I1I1I();
!(async () => {
  if (!lIiill) {
    console.log("‚ö† ËØ∑ÂÖàÂÆö‰πâÂøÖË¶ÅÁöÑÁéØÂ¢ÉÂèòÈáèÂêéÂÜçËøêË°åËÑöÊú¨");
    return;
  }
  const Iiii1l = li1lIl.parseUrl(lIiill);
  if (!Iiii1l) {
    console.log("‚ö† ËØ∑Â°´ÂÜôÊ†ºÂºèÊ≠£Á°ÆÁöÑÈìæÊé•");
    return;
  }
  $.activityUrl = lIiill;
  $.activityId = li1lIl.getUrlParameter(lIiill, "activityId");
  $.hostname = Iiii1l?.["hostname"];
  if ($.hostname) {
    if ($.hostname.includes("cjhy")) {
      if (iIII === "false") {
        console.log("\n‚ùå  Â∑≤ËÆæÁΩÆÂÖ®Â±ÄÂÖ≥Èó≠CJÁõ∏ÂÖ≥Ê¥ªÂä®\n");
        return;
      } else {
        $.activityMode = "cjhy";
      }
    } else {
      if ($.hostname.includes("lzkj")) {
        if (IIill1 === "false") {
          console.log("\n‚ùå  Â∑≤ËÆæÁΩÆÂÖ®Â±ÄÂÖ≥Èó≠LZÁõ∏ÂÖ≥Ê¥ªÂä®\n");
          return;
        } else {
          $.activityMode = "lzkj";
          $.hostname = "lzkj-isv.isvjd.com";
        }
      }
    }
    $.baseUrl = "https://" + $.hostname;
    $.origin = $.baseUrl;
  }
  if (!$.activityId || !$.activityMode || !$.hostname) {
    console.log("‚ö† ËØ∑Â°´ÂÜôÊ†ºÂºèÊ≠£Á°ÆÁöÑÂèòÈáè");
    return;
  }
  Iiii1l?.["pathname"]["includes"]("lzclient") && ($.activityUrl = $.baseUrl + "/wxDrawActivity/activity/activity?activityId=" + $.activityId);
  try {
    l1IIIl = parseInt(l1IIIl) > 0 ? parseInt(l1IIIl) : 0;
  } catch {
    l1IIIl = 0;
  }
  try {
    Iiii11 = parseInt(Iiii11);
  } catch {
    Iiii11 = 0;
  }
  $.drawIntervalTimes = $.activityMode === "cjhy" ? 1000 : 500;
  if (IiliI1) {
    try {
      const IIilil = parseInt(IiliI1) * 1000;
      $.drawIntervalTimes = IIilil;
    } catch {
      console.log("Ëá™ÂÆö‰πâÊäΩÂ•ñÈó¥ÈöîÊ†ºÂºèÈîôËØØÔºåÂ∑≤‰ΩøÁî®ÈªòËÆ§ÂÄº");
    }
  }
  li1lIi.config({
    title: $.name
  });
  console.log("Ê¥ªÂä®ÂÖ•Âè£Ôºö" + $.activityUrl);
  console.log("\nÊòØÂê¶Êé®ÈÄÅÈÄöÁü•„Äê" + (Il1lIi == true ? "ÈÄöÁü•" : "‰∏çÈÄöÁü•") + "„Äë ÊòØÂê¶ÂºÄÂç° „Äê" + (iilili == true ? "ÂºÄÂç°" : "‰∏çÂºÄÂç°") + "„Äë");
  console.log("\nÂΩìÂâçËÆæÂÆöËøûÁª≠ „Äê" + iiiii1 + "„Äë Ê¨°Êó†ÊäΩÂ•ñÊ¨°Êï∞Ë∑≥Âá∫");
  console.log("\nÂΩìÂâçËÆæÂÆö 493 ÊòØÂê¶ÁªßÁª≠ËøêË°å„Äê" + (l1IIIi == true ? "‰∏çÈÄÄÂá∫" : "ÈÄÄÂá∫") + "„Äë");
  if (!i111i1) {
    for (let i1II1l = 0; i1II1l < l11I; i1II1l++) {
      if (i1II1l > iiiii1 && llllli) {
        console.log("\nÊ£ÄÊµãÂà∞Â§öÊ¨°Êó†ÊäΩÂ•ñÊ¨°Êï∞ÔºåË∑≥ËøáÊ≠§Ê¨°ËøêË°å\n");
        break;
      }
      $.outFlag = false;
      if (lIiili[i1II1l]) {
        $.index = i1II1l + 1;
        iI1I1 = lIiili[i1II1l];
        IiliII = lIiili[i1II1l];
        li1lIl.setCookie(iI1I1);
        $.UserName = decodeURIComponent(li1lIl.getCookieValue(iI1I1, "pt_pin"));
        $.UA = li1lIl.genUA($.UserName);
        $.UUID = li1lIl.genUuid("xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx");
        $.te = Math.floor(Math.random() * 9000) + 1000;
        $.message = li1lIi.create($.index, $.UserName);
        $.nickName = "";
        console.log("\n******ÂºÄÂßã„Äê‰∫¨‰∏úË¥¶Âè∑" + $.index + "„Äë" + ($.nickName || $.UserName) + "******\n");
        await I11111();
        li1lIl.unsetCookie();
        if ($.outFlag || $.runEnd) {
          break;
        }
      }
    }
  } else {
    console.log("\nüîÄ Â∑≤ÂºÄÂêØÂπ∂ÂèëÊ®°ÂºèÔºåÂΩìÂâçËÆæÁΩÆÁ∫øÁ®ãÊï∞‰∏∫ " + l1IlI);
    await l111();
  }
  Il1lIi && li1lIi.getMessage() && (li1lIi.updateContent(li1lIi.content + ("\n„ÄêÊ¥ªÂä®Âú∞ÂùÄ„Äë" + $.activityUrl)), await li1lIi.push());
})().catch(IIl1li => $.logErr(IIl1li)).finally(() => $.done());
async function I11111() {
  try {
    $.skipRun = false;
    $.isMember = false;
    $.needJoinMember = false;
    $.secretPin = "";
    $.pinToken = "";
    $.LZ_AES_PIN = "";
    Ii11iI = "";
    if ($.skipRun || $.runEnd || $.outFlag) {
      return;
    }
    await iiIllI($.activityUrl);
    await $.wait(500);
    if ($.skipRun) {
      console.log("Ëé∑Âèñ LZ_TOKEN Â§±Ë¥•ÔºÅ");
      $.message.fix("Ëé∑Âèñ[LZ_TOKEN]Â§±Ë¥•");
      return;
    }
    if ($.outFlag || $.runEnd) {
      return;
    }
    if (!$.venderId) {
      await lIll1I("getSimpleActInfoVo");
      if (!$.venderId) {
        console.log("getSimpleActInfoVo Êú™ËÉΩËé∑ÂèñÂ∫óÈì∫‰ø°ÊÅØ");
        $.message.fix("Êú™ËÉΩËé∑ÂèñÂ∫óÈì∫‰ø°ÊÅØ");
        $.runEnd = true;
        return;
      }
      if (!$.activityType) {
        console.log("getSimpleActInfoVo Êú™ËÉΩËé∑ÂèñÊ¥ªÂä®Á±ªÂûã");
        $.message.fix("Êú™ËÉΩËé∑ÂèñÊ¥ªÂä®Á±ªÂûã");
        $.runEnd = true;
        return;
      }
      switch ($.activityType) {
        case 3:
        case 4:
        case 11:
        case 12:
        case 13:
        case 26:
        case 124:
        case 125:
        case 128:
        case 129:
          break;
        default:
          console.log("‚ùå ÂΩìÂâçÊ¥ªÂä®Á±ªÂûãÔºà" + $.activityType + "ÔºâÊöÇ‰∏çÂèóÊú¨ËÑöÊú¨ÊîØÊåÅÔºåËØ∑ËÅîÁ≥ª‰ΩúËÄÖËøõË°åÂèçÈ¶àÔºÅ");
          $.runEnd = true;
          return;
      }
      switch ($.activityType) {
        case 3:
        case 4:
        case 11:
        case 12:
        case 13:
          $.drawApiPath = "/wxDrawActivity/start";
          break;
        case 26:
          $.drawApiPath = "/wxPointDrawActivity/start";
          break;
        case 124:
          $.drawApiPath = "/wxScratchActive/start";
          break;
        case 125:
          $.drawApiPath = "/wxPointBlindBox/start";
          break;
        case 128:
          $.drawApiPath = "/wxGashaponActive/start";
          break;
        case 129:
          $.drawApiPath = "/wxDollGrabbing/start";
          break;
      }
      $.activityMode === "cjhy" && !$.defenseUrls && ($.defenseUrls = ["/wxScratchActive/start", "/wxPointDrawActivity/start", "/wxPointBlindBox/start", "/wxGashaponActive/start", "/wxDollGrabbing/start", "/wxDrawActivity/start", "/wxShopFollowActivity/getPrize", "/wx/completeInfoActivity/save", "/activity/daily/wx/grabGift", "/sign/wx/signUp", "/sign/sevenDay/wx/signUp", "/wxTeam/saveCaptain", "/wxTeam/saveMember"]);
    }
    $.token = await IiIIil(IiliII, $.baseUrl);
    if (!$.token) {
      console.log("Ëé∑Âèñ Token Â§±Ë¥•ÔºÅ");
      $.message.fix("Ëé∑Âèñ[Token]Â§±Ë¥•");
      return;
    }
    if ($.defenseUrls && $.defenseUrls.includes($.drawApiPath)) {
      await lIll1I("initPinToken");
      if ($.runEnd || $.skipRun || $.outFlag) {
        return;
      }
      if (!$.pinToken) {
        console.log("Ëé∑Âèñ pinToken Â§±Ë¥•ÔºÅ");
        $.message.fix("Ëé∑Âèñ[pinToken]Â§±Ë¥•");
        return;
      }
    } else {
      await lIll1I("getMyPing");
      if ($.runEnd || $.skipRun || $.outFlag) {
        return;
      }
      if (!$.secretPin) {
        console.log("Êú™ËÉΩËé∑ÂèñÁî®Êà∑Èâ¥ÊùÉ‰ø°ÊÅØÔºÅ");
        $.message.fix("Êú™ËÉΩËé∑ÂèñÁî®Êà∑Èâ¥ÊùÉ‰ø°ÊÅØ");
        return;
      }
    }
    $.activityMode === "cjhy" ? await $.wait(1000) : await $.wait(500);
    switch ($.activityMode) {
      case "lzkj":
        $.formatPin = encodeURIComponent($.secretPin);
        break;
      case "cjhy":
        $.formatPin = encodeURIComponent(encodeURIComponent($.secretPin));
        break;
    }
    await $.wait(500);
    switch ($.activityMode) {
      case "lzkj":
        await lIll1I("accessLogWithAD");
        break;
      case "cjhy":
        await lIll1I("accessLog");
        break;
    }
    await $.wait(500);
    if (iilili) {
      await lIll1I("getOpenCardStatus");
      if ($.outFlag && $.skipRun) {
        return;
      }
      if (!$.isMember) {
        const Ii11ii = await li1lIl.joinShopMember($.venderId);
        Ii11ii && (console.log("Âä†ÂÖ•Â∫óÈì∫‰ºöÂëòÊàêÂäü"), $.isMember = true);
      }
      $.activityMode === "cjhy" ? await $.wait(1000) : await $.wait(500);
    }
    $.activityContent = "";
    await lIll1I("activityContent");
    if (!$.activityContent) {
      console.log("Êú™ËÉΩËé∑ÂèñÂà∞Ê¥ªÂä®‰ø°ÊÅØ");
      $.message.fix("Êú™ËÉΩËé∑ÂèñÊ¥ªÂä®‰ø°ÊÅØ");
      return;
    }
    $.activityMode === "cjhy" ? await $.wait(1000) : await $.wait(500);
    $.canDrawTimes = $.activityContent?.["canDrawTimes"] || 0;
    const lIiil = $.activityContent?.["dayMaxDraw"];
    lIiil && $.canDrawTimes > lIiil && ($.canDrawTimes = lIiil);
    const iII1ll = $.activityContent.content,
      I1111i = $.activityContent?.["needFollow"] || false,
      iliiI = $.activityContent?.["hasFollow"] || false;
    if ($.index === 1) {
      let llIi = "";
      for (let li1l1I = 0; li1l1I < iII1ll.length; li1l1I++) {
        const Il1lI1 = iII1ll[li1l1I].name,
          lIll11 = iII1ll[li1l1I].type,
          iIlIIl = iII1ll[li1l1I].id;
        if (iIlIIl === 0 || lIll11 === 0) {
          llIi += "Ë∞¢Ë∞¢ÂèÇ‰∏é";
          break;
        } else {
          llIi += "" + Il1lI1 + (lIll11 === 8 ? "[‰∏ì‰∫´‰ª∑]" : lIll11 === 7 ? "[ÂÆûÁâ©]" : "");
          li1l1I !== iII1ll.length - 1 && (llIi += "Ôºå");
        }
      }
      await lIll1I("shopInfo");
      $.activityMode === "cjhy" ? await $.wait(1000) : await $.wait(500);
      console.log(($.shopName ? "Â∫óÈì∫ÂêçÁß∞Ôºö" + $.shopName + "\n" : "") + "Â∫óÈì∫ÈìæÊé•Ôºöhttps://shop.m.jd.com/?venderId=" + $.venderId + "\nÊ¥ªÂä®Â•ñÂìÅÔºö" + llIi + "\n");
      li1lIi.updateContent(li1lIi.content + (($.shopName && "\n„ÄêÂ∫óÈì∫ÂêçÁß∞„Äë" + $.shopName) + "\n„ÄêÊ¥ªÂä®Â•ñÂìÅ„Äë" + llIi));
      let Ii11il = $.activityContent?.["startTime"],
        ilii1 = $.activityContent?.["endTime"];
      if ((!Ii11il || !ilii1) && $.activityContent?.["rule"]) {
        try {
          const lIii = /ÊäΩÂ•ñÊó∂Èó¥Ôºö(\d{4}-\d{2}-\d{2} \d{2}:\d{2}) Ëá≥ (\d{4}-\d{2}-\d{2} \d{2}:\d{2})Ôºõ/,
            ii1 = $.activityContent.rule.match(lIii);
          ii1 && ii1.length === 3 && (Ii11il = new Date(ii1[1]).getTime(), ilii1 = new Date(ii1[2]).getTime());
        } catch {}
      }
      const I11lI1 = Date.now();
      if (ilii1 && I11lI1 > ilii1) {
        const lII1li = $.time("yyyy-MM-dd HH:mm", ilii1);
        console.log("Ê¥ªÂä®Â∑≤‰∫é " + lII1li + " ÁªìÊùüÔºå‰∏ãÊ¨°Êó©ÁÇπÊù•Âêß~");
        $.message.fix("Ê¥ªÂä®Â∑≤ÁªìÊùüÔºåÁªìÊùüÊó∂Èó¥Ôºö" + lII1li);
        $.runEnd = true;
        return;
      }
      if (Ii11il && I11lI1 < Ii11il) {
        const lIilI = $.time("yyyy-MM-dd HH:mm", Ii11il);
        console.log("Ê¥ªÂä®Â∞ÜÂú® " + lIilI + " ÂºÄÂßãÔºåÊôöÁÇπÂÜçÊù•Âêß~");
        $.message.fix("Ê¥ªÂä®Â∞öÊú™ÂºÄÂßãÔºåÂºÄÂßãÊó∂Èó¥Ôºö" + lIilI);
        $.runEnd = true;
        return;
      }
    }
    switch ($.activityType) {
      case 3:
      case 4:
      case 11:
      case 12:
      case 13:
        if (I1111i && !iliiI) {
          await lIll1I("followShop");
          $.activityMode === "cjhy" ? await $.wait(1000) : await $.wait(500);
        }
        break;
      case 26:
      case 124:
      case 125:
      case 128:
      case 129:
        await lIll1I("followShop");
        break;
    }
    if ($.needJoinMember || $.outFlag) {
      return;
    }
    if ($.canDrawTimes === 0) {
      switch ($.activityType) {
        case 3:
        case 4:
        case 11:
        case 12:
        case 13:
          await lIll1I("getGiveContent");
          $.activityMode === "cjhy" ? await $.wait(1000) : await $.wait(500);
          if ($.followTaskInfo) {
            const II1I1i = $.followTaskInfo?.["skuIdsList"],
              II1I1l = $.followTaskInfo?.["followTimes"],
              ilIl1I = $.followTaskInfo?.["hasGetGiveTimes"],
              iiI = $.followTaskInfo?.["giveTimes"],
              lIiI = $.followTaskInfo?.["maxGiveTimes"],
              lII1lI = Math.trunc(II1I1i.length / II1I1l * iiI);
            if (ilIl1I < lIiI && ilIl1I < lII1lI) {
              let lIi1 = (lIiI - ilIl1I) * II1I1l;
              for (let iIiI1l = 0; iIiI1l < II1I1i.length; iIiI1l++) {
                $.skuId = II1I1i[iIiI1l];
                await lIll1I("followGoods");
                $.activityMode === "cjhy" ? await $.wait(1000) : await $.wait(500);
                if (iIiI1l === lIi1 - 1) {
                  break;
                }
              }
              $.activityContent = "";
              await lIll1I("activityContent");
              if (!$.activityContent) {
                console.log("Êú™ËÉΩËé∑ÂèñÂà∞Ê¥ªÂä®‰ø°ÊÅØ");
                $.message.fix("Êú™ËÉΩËé∑ÂèñÊ¥ªÂä®‰ø°ÊÅØ");
                return;
              }
              $.canDrawTimes = $.activityContent?.["canDrawTimes"] || 0;
              const lIill = $.activityContent?.["dayMaxDraw"] || 0;
              $.canDrawTimes > lIill && ($.canDrawTimes = lIill);
              $.activityMode === "cjhy" ? await $.wait(1000) : await $.wait(500);
              console.log("");
            }
          }
          break;
        case 26:
        case 124:
        case 125:
        case 128:
        case 129:
          break;
      }
    }
    if ($.canDrawTimes <= 0) {
      switch ($.activityType) {
        case 13:
          console.log("‰ªäÂ§©Ê≤°ÊúâÊäΩÂ•ñÊú∫‰ºö‰∫ÜÔºåÊòéÂ§©ÂÜçÊù•Âêß~");
          $.message.fix("‰ªäÊó•Â∑≤Êó†ÊäΩÂ•ñÊú∫‰ºö");
          break;
        case 3:
        case 4:
        case 11:
        case 12:
        case 26:
        case 124:
        case 125:
        case 128:
        case 129:
          console.log("Ê≤°ÊúâÊäΩÂ•ñÊú∫‰ºö‰∫Ü~");
          $.message.fix("ÊäΩÂ•ñÊú∫‰ºö‰∏çË∂≥");
          break;
      }
      return;
    }
    $.drawTimes = 0;
    $.drawStop = false;
    $.drawMissTimes = 0;
    for (let iIiI1i = 1; $.canDrawTimes--; iIiI1i++) {
      $.drawError = "";
      await lIll1I("start");
      if ($.drawError) {
        $.drawError.indexOf("ÁÅ´ÁàÜ") > -1 && ($.canDrawTimes += 1);
        $.activityMode === "cjhy" && ($.drawError.indexOf("Êì¶ËÇ©") > -1 || $.drawError.indexOf("ÁºìÂ≠ò") > -1) && ($.canDrawTimes += 1);
        if (Iiii11 && $.drawMissTimes >= Iiii11) {
          break;
        }
        if ($.drawStop || $.needJoinMember || $.runEnd) {
          break;
        }
      }
      if ($.canDrawTimes <= 0) {
        break;
      }
      if ($.drawTimes >= 8 && [26, 124, 125, 128, 129].includes($.activityType)) {
        console.log("\nÊäΩÂ•ñÊ¨°Êï∞ËøáÂ§öÔºåÂâ©‰Ωô" + $.canDrawTimes + "Ê¨°Êú∫‰ºöÔºå‰∏ãÊ¨°ÂÜçÁªßÁª≠Âêß~");
        $.message.insert("ÊäΩÂ•ñÊ¨°Êï∞ËøáÂ§ö‰∏ãÊ¨°ÂÜçÊäΩÔºåÂâ©‰Ωô" + $.canDrawTimes + "Ê¨°Êú∫‰ºö");
        break;
      }
      await $.wait($.drawIntervalTimes);
    }
  } catch (ilIl1i) {
    console.log("‚ùå ËÑöÊú¨ËøêË°åÈÅáÂà∞‰∫ÜÈîôËØØ\n" + ilIl1i);
  }
}
async function l111() {
  await iiIllI($.activityUrl);
  if ($.skipRun) {
    console.log("Ëé∑Âèñ LZ_TOKEN Â§±Ë¥•ÔºÅ");
    li1lIi.updateContent(li1lIi.content + "Ëé∑Âèñ[LZ_TOKEN]Â§±Ë¥•\n");
    return;
  }
  await lIll1I("getSimpleActInfoVo");
  if (!$.venderId || !$.activityType) {
    console.log("getSimpleActInfoVo Êú™ËÉΩËé∑ÂèñÂ∫óÈì∫‰ø°ÊÅØ");
    li1lIi.updateContent(li1lIi.content + "Êú™ËÉΩËé∑ÂèñÂ∫óÈì∫‰ø°ÊÅØ\n");
    return;
  }
  switch ($.activityType) {
    case 3:
    case 4:
    case 11:
    case 12:
    case 13:
    case 26:
    case 124:
    case 125:
    case 128:
    case 129:
      break;
    default:
      console.log("‚ùå ÂΩìÂâçÊ¥ªÂä®Á±ªÂûãÔºà" + $.activityType + "ÔºâÊöÇ‰∏çÂèóÊú¨ËÑöÊú¨ÊîØÊåÅÔºåËØ∑ËÅîÁ≥ª‰ΩúËÄÖËøõË°åÂèçÈ¶àÔºÅ");
      return;
  }
  switch ($.activityType) {
    case 3:
    case 4:
    case 11:
    case 12:
    case 13:
      $.drawApiPath = "/wxDrawActivity/start";
      break;
    case 26:
      $.drawApiPath = "/wxPointDrawActivity/start";
      break;
    case 124:
      $.drawApiPath = "/wxScratchActive/start";
      break;
    case 125:
      $.drawApiPath = "/wxPointBlindBox/start";
      break;
    case 128:
      $.drawApiPath = "/wxGashaponActive/start";
      break;
    case 129:
      $.drawApiPath = "/wxDollGrabbing/start";
      break;
  }
  await lIll1I("shopInfo");
  $.activityMode === "cjhy" && !$.defenseUrls && ($.defenseUrls = ["/wxScratchActive/start", "/wxPointDrawActivity/start", "/wxPointBlindBox/start", "/wxGashaponActive/start", "/wxDollGrabbing/start", "/wxDrawActivity/start", "/wxShopFollowActivity/getPrize", "/wx/completeInfoActivity/save", "/activity/daily/wx/grabGift", "/sign/wx/signUp", "/sign/sevenDay/wx/signUp", "/wxTeam/saveCaptain", "/wxTeam/saveMember"]);
  console.log("");
  await li1lIl.concTask(l1IlI, lIiili, async (l1i1ll, l1i1li) => {
    const Ili1I = decodeURIComponent(li1lIl.getCookieValue(l1i1ll, "pt_pin")),
      I1IiII = li1lIl.genUA(Ili1I),
      Ili11 = li1lIi.create(l1i1li, Ili1I);
    let iiIiI = "",
      lIIlI1 = "",
      ilill1 = "",
      iIIiI1 = "",
      IIIi1I = "",
      l1i1lI = "",
      I11 = "",
      lll11 = false,
      il1iil = false,
      iiIi1 = false;
    l1i1lI = await lI1i1();
    if (!l1i1lI) {
      Ili11.fix("Ëé∑Âèñ[LZ_COOKIE]Â§±Ë¥•");
      console.log(Ili11.getInlineContent());
      return;
    }
    iiIiI = await IiIIil(l1i1ll, $.baseUrl);
    if (!iiIiI) {
      Ili11.fix("Ëé∑Âèñ[Token]Â§±Ë¥•");
      console.log(Ili11.getInlineContent());
      return;
    }
    if ($.activityMode === "cjhy") {
      await il1ili("initPinToken");
      if (!ilill1) {
        Ili11.fix("Ëé∑Âèñ[pinToken]Â§±Ë¥•");
        console.log(Ili11.getInlineContent());
        return;
      }
    } else {
      await il1ili("getMyPing");
    }
    if (!lIIlI1) {
      Ili11.fix("Êú™ËÉΩËé∑ÂèñÁî®Êà∑Èâ¥ÊùÉ‰ø°ÊÅØ");
      console.log(Ili11.getInlineContent());
      return;
    }
    switch ($.activityMode) {
      case "lzkj":
        I11 = encodeURIComponent(lIIlI1);
        break;
      case "cjhy":
        I11 = encodeURIComponent(encodeURIComponent(lIIlI1));
        break;
    }
    switch ($.activityMode) {
      case "lzkj":
        await il1ili("accessLogWithAD");
        break;
      case "cjhy":
        await il1ili("accessLog");
        break;
    }
    let il1iii = true;
    if (iilili) {
      await il1ili("getOpenCardStatus");
      if (il1iil) {
        console.log(Ili11.getInlineContent());
        return;
      }
      if (!il1iii) {
        const lI1lI = await li1lIl.joinShopMember($.venderId, l1i1ll);
        if (lI1lI) {
          Ili11.insert("Âä†ÂÖ•Â∫óÈì∫‰ºöÂëòÊàêÂäü");
          il1iii = true;
        }
      }
    }
    let lII11l = "",
      ilillI = 0;
    await il1ili("activityContent");
    if (iiIi1) {
      console.log(Ili11.getInlineContent());
      return {
        runEnd: true
      };
    }
    if (!lII11l) {
      Ili11.fix("Êú™ËÉΩËé∑ÂèñÊ¥ªÂä®‰ø°ÊÅØ");
      console.log(Ili11.getInlineContent());
      return;
    }
    ilillI = lII11l?.["canDrawTimes"] || 0;
    const iIIiII = lII11l?.["dayMaxDraw"];
    iIIiII && ilillI > iIIiII && (ilillI = iIIiII);
    const IIi1i1 = lII11l.content,
      I1IiI1 = lII11l?.["needFollow"] || false,
      IlIl1i = lII11l?.["hasFollow"] || false;
    if (l1i1li === 1) {
      let lli11I = "";
      for (let lIIlIi = 0; lIIlIi < IIi1i1.length; lIIlIi++) {
        const ililli = IIi1i1[lIIlIi].name,
          ii11l = IIi1i1[lIIlIi].type,
          iIIiIi = IIi1i1[lIIlIi].id;
        if (iIIiIi === 0 || ii11l === 0) {
          lli11I += "Ë∞¢Ë∞¢ÂèÇ‰∏é";
          break;
        } else {
          lli11I += "" + ililli + (ii11l === 8 ? "[‰∏ì‰∫´‰ª∑]" : ii11l === 7 ? "[ÂÆûÁâ©]" : "");
          lIIlIi !== IIi1i1.length - 1 && (lli11I += "Ôºå");
        }
      }
      console.log("\n" + ($.shopName ? "Â∫óÈì∫ÂêçÁß∞Ôºö" + $.shopName + "\n" : "") + "Â∫óÈì∫ÈìæÊé•Ôºöhttps://shop.m.jd.com/?venderId=" + $.venderId + "\nÊ¥ªÂä®Â•ñÂìÅÔºö" + lli11I + "\n");
      li1lIi.updateContent(li1lIi.content + (($.shopName && "\n„ÄêÂ∫óÈì∫ÂêçÁß∞„Äë" + $.shopName) + "\n„ÄêÊ¥ªÂä®Â•ñÂìÅ„Äë" + lli11I));
      let ii1lI1 = lII11l?.["startTime"],
        ii11i = lII11l?.["endTime"];
      if ((!ii1lI1 || !ii11i) && lII11l?.["rule"]) {
        try {
          const ililll = /ÊäΩÂ•ñÊó∂Èó¥Ôºö(\d{4}-\d{2}-\d{2} \d{2}:\d{2}) Ëá≥ (\d{4}-\d{2}-\d{2} \d{2}:\d{2})Ôºõ/,
            il1Ii = lII11l.rule.match(ililll);
          il1Ii && il1Ii.length === 3 && (ii1lI1 = new Date(il1Ii[1]).getTime(), ii11i = new Date(il1Ii[2]).getTime());
        } catch {}
      }
      const lIIlIl = Date.now();
      if (ii11i && lIIlIl > ii11i) {
        const iIIiIl = $.time("yyyy-MM-dd HH:mm", ii11i);
        console.log("Ê¥ªÂä®Â∑≤‰∫é " + iIIiIl + " ÁªìÊùüÔºå‰∏ãÊ¨°Êó©ÁÇπÊù•Âêß~");
        Ili11.fix("Ê¥ªÂä®Â∑≤ÁªìÊùüÔºåÁªìÊùüÊó∂Èó¥Ôºö" + iIIiIl);
        return {
          runEnd: true
        };
      }
      if (ii1lI1 && lIIlIl < ii1lI1) {
        const IiIli1 = $.time("yyyy-MM-dd HH:mm", ii1lI1);
        console.log("Ê¥ªÂä®Â∞ÜÂú® " + IiIli1 + " ÂºÄÂßãÔºåÊôöÁÇπÂÜçÊù•Âêß~");
        Ili11.fix("Ê¥ªÂä®Â∞öÊú™ÂºÄÂßãÔºåÂºÄÂßãÊó∂Èó¥Ôºö" + IiIli1);
        return {
          runEnd: true
        };
      }
    }
    switch ($.activityType) {
      case 3:
      case 4:
      case 11:
      case 12:
      case 13:
        I1IiI1 && !IlIl1i && (await il1ili("followShop"));
        break;
      case 26:
      case 124:
      case 125:
      case 128:
      case 129:
        await il1ili("followShop");
        break;
    }
    if (lll11 || il1iil) {
      console.log(Ili11.getInlineContent());
      return;
    }
    let IIIi11 = "";
    if (ilillI === 0) {
      switch ($.activityType) {
        case 3:
        case 4:
        case 11:
        case 12:
        case 13:
          await il1ili("getGiveContent");
          break;
        case 26:
        case 124:
        case 125:
        case 128:
        case 129:
          break;
      }
    }
    if (ilillI <= 0) {
      switch ($.activityType) {
        case 13:
          Ili11.fix("‰ªäÊó•Â∑≤Êó†ÊäΩÂ•ñÊú∫‰ºö");
          break;
        case 3:
        case 4:
        case 11:
        case 12:
        case 26:
        case 124:
        case 125:
        case 128:
        case 129:
          Ili11.fix("ÊäΩÂ•ñÊú∫‰ºö‰∏çË∂≥");
          break;
      }
      console.log(Ili11.getInlineContent());
      return;
    }
    let I1I = 0,
      liIi1I = 0,
      il1ill = false;
    for (let I1lll = 1; ilillI--; I1lll++) {
      await il1ili("start");
      if (ilillI <= 0) {
        break;
      }
      if (I1I >= 8 && [26, 124, 125, 128, 129].includes($.activityType)) {
        Ili11.insert("ÊäΩÂ•ñÊ¨°Êï∞ËøáÂ§ö‰∏ãÊ¨°ÂÜçÊäΩÔºåÂâ©‰Ωô" + ilillI + "Ê¨°Êú∫‰ºö");
        break;
      }
    }
    console.log(Ili11.getInlineContent());
    async function il1ili(lIIIli) {
      let lIIIll = "",
        i11I = "",
        iI1III = "POST";
      switch (lIIIli) {
        case "getMyPing":
          lIIIll = $.baseUrl + "/customer/getMyPing";
          i11I = "token=" + iiIiI + "&fromType=APP&userId=" + $.venderId;
          break;
        case "initPinToken":
          iI1III = "GET";
          lIIIll = $.baseUrl + "/customer/initPinToken?status=1&activityId=" + $.activityId + "&jdToken=" + iiIiI + "&source=01&venderId=" + $.venderId + "&uuid=" + li1lIl.genUuid("xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx") + "&clientTime=" + Date.now();
          break;
        case "accessLog":
          lIIIll = $.baseUrl + "/common/accessLog";
          i11I = "venderId=" + $.venderId + "&code=" + $.activityType + "&pin=" + I11 + "&activityId=" + $.activityId + "&pageUrl=" + encodeURIComponent($.activityUrl) + "&subType=app&adSource=";
          break;
        case "accessLogWithAD":
          lIIIll = $.baseUrl + "/common/accessLogWithAD";
          i11I = "venderId=" + $.venderId + "&code=" + $.activityType + "&pin=" + I11 + "&activityId=" + $.activityId + "&pageUrl=" + encodeURIComponent($.activityUrl) + "&subType=app";
          break;
        case "getOpenCardStatus":
          switch ($.activityType) {
            case 3:
            case 4:
            case 11:
            case 12:
            case 13:
              switch ($.activityMode) {
                case "lzkj":
                  lIIIll = $.baseUrl + "/wxCommonInfo/getActMemberInfo";
                  i11I = "activityId=" + $.activityId + "&venderId=" + $.venderId + "&pin=" + I11;
                  break;
                case "cjhy":
                  lIIIll = $.baseUrl + "/mc/new/brandCard/common/shopAndBrand/getOpenCardInfo";
                  i11I = "venderId=" + $.venderId + "&buyerPin=" + I11 + "&activityType=" + $.activityType;
                  break;
              }
              break;
            case 26:
              switch ($.activityMode) {
                case "lzkj":
                  lIIIll = $.baseUrl + "/crmCard/common/coupon/getOpenCardStatus";
                  i11I = "venderId=" + $.venderId + "&pin=" + I11;
                  break;
                case "cjhy":
                  lIIIll = $.baseUrl + "/common/joinConfig/check";
                  i11I = "venderId=" + $.venderId + "&pin=" + I11 + "&activityType=" + $.activityType + "&activityId=" + $.activityId;
                  break;
              }
              break;
            case 124:
            case 125:
            case 128:
            case 129:
              lIIIll = $.baseUrl + "/common/joinConfig/check";
              i11I = "venderId=" + $.venderId + "&pin=" + I11 + "&activityType=" + $.activityType + "&activityId=" + $.activityId;
              break;
          }
          break;
        case "activityContent":
          let l1Ii1I = "";
          switch ($.activityType) {
            case 3:
            case 4:
            case 11:
            case 12:
            case 13:
              l1Ii1I = "wxDrawActivity/activityContent";
              break;
            case 26:
              l1Ii1I = "wxPointDrawActivity/activityContent";
              break;
            case 124:
              l1Ii1I = "wxScratchActive/activityContent";
              break;
            case 125:
              l1Ii1I = "wxPointBlindBox/activityContent";
              break;
            case 128:
              l1Ii1I = "wxGashaponActive/activityContent";
              break;
            case 129:
              l1Ii1I = "wxDollGrabbing/activityContent";
              break;
          }
          lIIIll = $.baseUrl + "/" + l1Ii1I;
          i11I = "activityId=" + $.activityId + "&pin=" + I11;
          break;
        case "followShop":
          switch ($.activityMode) {
            case "lzkj":
              lIIIll = $.baseUrl + "/wxActionCommon/followShop";
              i11I = "userId=" + $.venderId + "&buyerNick=" + I11 + "&activityId=" + $.activityId + "&activityType=" + $.activityType;
              break;
            case "cjhy":
              lIIIll = $.baseUrl + "/wxActionCommon/newFollowShop";
              i11I = "venderId=" + $.venderId + "&buyerPin=" + I11 + "&activityId=" + $.activityId + "&activityType=" + $.activityType;
              break;
          }
          break;
        case "getGiveContent":
          lIIIll = $.baseUrl + "/wxDrawActivity/getGiveContent";
          i11I = "pin=" + I11 + "&activityId=" + $.activityId;
          break;
        case "followGoods":
          lIIIll = $.baseUrl + "/wxDrawActivity/follow";
          i11I = "activityId=" + $.activityId + "&pin=" + I11 + "&skuId=" + IIIi11;
          break;
        case "start":
          lIIIll = "" + $.baseUrl + $.drawApiPath;
          $.defenseUrls && $.defenseUrls.includes($.drawApiPath) ? i11I = JSON.stringify({
            ecyText: iII1l1({
              actId: $.activityId,
              activityId: $.activityId,
              pin: encodeURIComponent(lIIlI1)
            }, ilill1, iIIiI1)
          }) : i11I = "activityId=" + $.activityId + "&pin=" + I11;
          break;
      }
      const I11II1 = {
        url: lIIIll,
        headers: {
          Origin: $.origin,
          Accept: "application/json",
          "Accept-Encoding": "gzip, deflate, br",
          "Accept-Language": "zh-CN,zh;q=0.9",
          Connection: "keep-alive",
          "Content-Type": ["saveCaptain", "saveMember"].includes(lIIIli) && $.activityMode === "cjhy" ? "application/json" : "application/x-www-form-urlencoded",
          Cookie: l1i1lI,
          "Sec-Fetch-Dest": "empty",
          "Sec-Fetch-Mode": "cors",
          "Sec-Fetch-Site": "same-origin",
          "User-Agent": I1IiII,
          "X-Requested-With": "XMLHttpRequest",
          Referer: $.activityUrl
        },
        body: i11I,
        timeout: 60000
      };
      iI1III === "GET" && (delete I11II1.body, delete I11II1.headers["Content-Type"]);
      const l1II = 1 + l1IIIl;
      let i1iIII = 0,
        i1l111 = null;
      while (i1iIII < l1II) {
        const {
          err: lIIIlI,
          res: Iiiil1,
          data: iI1IIi
        } = await li1II1(I11II1, iI1III);
        if (lIIIlI) {
          if (!["accessLog", "accessLogWithAD"].includes(lIIIli)) {
            if (typeof lIIIlI === "string" && lIIIlI.includes("Timeout awaiting 'request'")) {
              i1l111 = lIIIli + " ËØ∑Ê±ÇË∂ÖÊó∂Ôºâ";
            } else {
              const iI1IIl = Iiiil1?.["statusCode"];
              if (iI1IIl) {
                if ([403, 493].includes(iI1IIl)) {
                  i1l111 = lIIIli + " ËØ∑Ê±ÇÂ§±Ë¥•ÔºåIPË¢´ÈôêÂà∂ÔºàResponse code " + iI1IIl + "Ôºâ";
                } else {
                  if ([400, 404].includes(iI1IIl)) {
                    i1l111 = lIIIli + " ËØ∑Ê±ÇÈÖçÁΩÆÂèÇÊï∞ÈîôËØØÔºåËØ∑ËÅîÁ≥ªÂºÄÂèëËÄÖËøõË°åÂèçÈ¶àÔºàResponse code " + iI1IIl + "Ôºâ";
                  } else {
                    [500].includes(iI1IIl) && lIIIli === "start" && $.activityMode === "cjhy" && $.defenseUrls && $.defenseUrls.includes($.drawApiPath) ? I11II1.body = JSON.stringify({
                      ecyText: iII1l1({
                        actId: $.activityId,
                        activityId: $.activityId,
                        pin: encodeURIComponent(lIIlI1)
                      }, ilill1, iIIiI1)
                    }) : i1l111 = lIIIli + " ËØ∑Ê±ÇÂ§±Ë¥•ÔºàResponse code " + iI1IIl + "Ôºâ";
                  }
                }
              } else {
                i1l111 = lIIIli + " ËØ∑Ê±ÇÂ§±Ë¥• => " + (lIIIlI.message || lIIIlI);
              }
            }
            i1iIII++;
          }
        } else {
          const l1I1 = li1lIl.getResponseCookie(Iiiil1, l1i1lI),
            IiIlli = false;
          switch (lIIIli) {
            case "getMyPing":
              IIIi1I = li1lIl.getCookieValue(l1I1, "LZ_AES_PIN");
              break;
            case "initPinToken":
              IIIi1I = li1lIl.getCookieValue(l1I1, "LZ_AES_PIN");
              ilill1 = li1lIl.getCookieValue(l1I1, "pToken");
              iIIiI1 = li1lIl.getCookieValue(l1I1, "te");
              break;
          }
          ["getMyPing", "followGoods", "start"].includes(lIIIli) && (l1i1lI = l1I1);
          !li1lIl.getCookieValue(l1i1lI, "LZ_AES_PIN") && IIIi1I && (l1i1lI += "LZ_AES_PIN=" + IIIi1I + "; ");
          !li1lIl.getCookieValue(l1i1lI, "pToken") && ilill1 && (l1i1lI += "pToken=" + ilill1 + "; ");
          !li1lIl.getCookieValue(l1i1lI, "AUTH_C_USER") && lIIlI1 && (l1i1lI += "AUTH_C_USER=" + lIIlI1 + "; ");
          !li1lIl.getCookieValue(l1i1lI, "te") && iIIiI1 && (l1i1lI += "te=" + iIIiI1 + "; ");
          if (["accessLog", "accessLogWithAD"].includes(lIIIli)) {
            break;
          }
          if (iI1IIi) {
            try {
              const llilIl = JSON.parse(iI1IIi);
              switch (lIIIli) {
                case "getMyPing":
                case "initPinToken":
                  if (llilIl.result === true && llilIl.data) {
                    lIIlI1 = llilIl.data?.["secretPin"];
                  } else {
                    if (llilIl.errorMessage) {
                      Ili11.fix(lIIIli + " " + llilIl.errorMessage);
                    }
                  }
                  break;
                case "getOpenCardStatus":
                  if (llilIl.result === true) {
                    if (llilIl.data) {
                      if (llilIl.data.hasOwnProperty("openCard")) {
                        il1iii = llilIl.data.openCard;
                      } else {
                        llilIl.data.hasOwnProperty("openedCard") && (il1iii = llilIl.data.openedCard);
                      }
                      if (typeof il1iii === "number") {
                        il1iii = il1iii === 1;
                      } else {
                        typeof il1iii === "undefined" && (il1iii = false);
                      }
                    } else {
                      il1iii = true;
                    }
                  } else {
                    llilIl.errorMessage ? llilIl.errorMessage.includes("Êì¶ËÇ©") && !llilIl?.["data"] ? (il1iil = true, Ili11.fix("Ë¥¶Âè∑Â∑≤Èªë")) : Ili11.fix(llilIl.errorMessage) : (il1iii = false, console.log("‚ùì" + lIIIli + " " + JSON.stringify(llilIl)));
                  }
                  break;
                case "activityContent":
                  if (llilIl.result === true && llilIl.data) {
                    lII11l = llilIl.data;
                  } else {
                    if (llilIl.errorMessage) {
                      for (let i1llI1 of ["Êú™ÂºÄÂßã", "ÁªìÊùü", "‰∏çÂ≠òÂú®", "‰∏çÂú®"]) {
                        if (llilIl.errorMessage.includes(i1llI1)) {
                          Ili11.fix(llilIl.errorMessage);
                          iiIi1 = true;
                          break;
                        }
                      }
                      Ili11.fix(llilIl.errorMessage);
                    } else {
                      console.log("‚ùì" + lIIIli + " " + JSON.stringify(llilIl));
                    }
                  }
                  break;
                case "followShop":
                  if (!(llilIl.result === true)) {
                    llilIl.errorMessage ? (["‰ºöÂëò", "ÂºÄÂç°"].some(lii1l1 => llilIl.errorMessage.includes(lii1l1)) && (lll11 = true, Ili11.fix("Ê¥ªÂä®‰ªÖÈôêÂ∫óÈì∫‰ºöÂëòÂèÇ‰∏é")), il1iil = true) : console.log("‚ùì" + lIIIli + " " + JSON.stringify(llilIl));
                  }
                  break;
                case "getGiveContent":
                  if (llilIl.result === true && llilIl.data) {
                    followTaskInfo = llilIl.data?.["follow"];
                  } else {
                    if (!llilIl.errorMessage) {
                      console.log("‚ùì" + lIIIli + " " + JSON.stringify(llilIl));
                    }
                  }
                  break;
                case "followGoods":
                  if (!(llilIl.result === true)) {
                    if (!llilIl.errorMessage) {
                      console.log("‚ùì" + lIIIli + " " + JSON.stringify(llilIl));
                    }
                  }
                  break;
                case "start":
                  if (llilIl.result === true && llilIl.data) {
                    I1I += 1;
                    ilillI = llilIl.data.canDrawTimes;
                    const i11l = llilIl.data.drawInfo;
                    if (i11l) {
                      switch (i11l.type) {
                        case 4:
                          switch ($.activityType) {
                            case 3:
                            case 4:
                            case 11:
                            case 12:
                            case 13:
                              ilillI += 1;
                              break;
                            case 26:
                            case 124:
                            case 125:
                            case 128:
                            case 129:
                              Ili11.insert("Á©∫Ê∞îüí®");
                              break;
                          }
                          break;
                        case 6:
                          Ili11.insert(i11l.name + "üê∂");
                          break;
                        case 7:
                          const l1Ii = llilIl.data.addressId,
                            IiIll1 = i11l.name;
                          let l1Il = "üéâ ÊÅ≠ÂñúËé∑ÂæóÂÆûÁâ©ÔºåÂ•ñÂìÅÂêçÁß∞Ôºö" + IiIll1 + "ÔºåÂèÇËÄÉ‰ª∑ÂÄºÔºö" + i11l.priceInfo + "(ÂÖÉ)";
                          if (i11l.showImage) {
                            l1Il += "\nÈ¢ÑËßàÂõæÁâáÔºö" + i11l.showImage;
                          }
                          console.log(l1Il);
                          const i1il11 = {
                              baseUrl: $.baseUrl,
                              cookie: l1i1lI,
                              ua: I1IiII,
                              activityId: $.activityId,
                              activityType: $.activityType,
                              venderId: [$.venderId, $.shopId],
                              secretPin: lIIlI1,
                              prizeName: IiIll1,
                              generateId: l1Ii
                            },
                            l1Ii1i = await iilill(i1il11);
                          !Il1lIi && l1Ii1i && (await li1lIi.sendNotify($.name + "‰∏≠Â•ñÈÄöÁü•", "„Äê‰∫¨‰∏úË¥¶Âè∑" + l1i1li + "„Äë\nÊäΩ‰∏≠ÂÆûÁâ© " + IiIll1 + "ÔºåÂ∑≤ÊàêÂäüËá™Âä®ÁôªËÆ∞Êî∂Ë¥ßÂú∞ÂùÄ\n\n" + $.activityUrl));
                          Ili11.insert(IiIll1 + "(" + (l1Ii1i ? "Â∑≤Â°´Âú∞ÂùÄ" : "Êú™Â°´Âú∞ÂùÄ") + ")üéÅ");
                          break;
                        case 8:
                          Ili11.insert("‰∏ì‰∫´‰ª∑üóëÔ∏è");
                          break;
                        case 9:
                          Ili11.insert(i11l.name + "üéüÔ∏è");
                          break;
                        case 13:
                        case 14:
                        case 15:
                          if (!Il1lIi) {
                            await li1lIi.sendNotify($.name + "‰∏≠Â•ñÈÄöÁü•", "„Äê‰∫¨‰∏úË¥¶Âè∑" + l1i1li + "„Äë\nÊäΩ‰∏≠ " + i11l.name + "\n\n" + $.activityUrl);
                          }
                          Ili11.insert(i11l.name + "üéÅ");
                          break;
                        case 16:
                          Ili11.insert(i11l.priceInfo + "Á∫¢ÂåÖüßß");
                          break;
                        default:
                          i11l.name.includes("Âà∏") ? Ili11.insert("‰ºòÊÉ†Âà∏üóëÔ∏è") : Ili11.insert(i11l.name);
                          break;
                      }
                    } else {
                      liIi1I += 1;
                      Ili11.insert("Á©∫Ê∞îüí®");
                    }
                  } else {
                    if (llilIl.errorMessage) {
                      drawError = llilIl.errorMessage;
                      ["‰∏äÈôê", "‰∏çË∂≥", "Ë∂ÖËøá", "ÈùûÊ≥ïÊìç‰Ωú", "ÊòéÂ§©"].some(lliIli => drawError.includes(lliIli)) && (il1ill = true, Ili11.insert(drawError));
                      ["Êú™ÂºÄÂßã", "ÁªìÊùü", "‰∏çÂ≠òÂú®", "‰∏çÂú®"].some(IlliII => drawError.includes(IlliII)) && (iiIi1 = true, Ili11.fix(drawError));
                      ["‰ºöÂëò", "ÂºÄÂç°"].some(ilIl => drawError.includes(ilIl)) && (lll11 = true, Ili11.fix(drawError));
                      !["ÁÅ´ÁàÜ", "Êì¶ËÇ©", "ÁºìÂ≠ò", "Êï∞ÊçÆÂøô"].some(ill1ii => drawError.includes(ill1ii)) && !il1ill && !lll11 && Ili11.insert(drawError || "");
                    } else {
                      console.log("‚ùì" + lIIIli + " " + JSON.stringify(llilIl));
                    }
                  }
                  break;
              }
              break;
            } catch (lllli1) {
              Ili11.fix("‚ùå " + lIIIli + " Êé•Âè£ÂìçÂ∫îÊï∞ÊçÆËß£ÊûêÂ§±Ë¥•: " + (lllli1.message || lllli1));
              IiIlli && (console.log("\n---------------------------------------------------\n"), console.log(l1i1lI), console.log("\n---------------------------------------------------\n"));
              i1iIII++;
            }
          } else {
            lIIIli === "start" && $.activityMode === "cjhy" && $.defenseUrls && $.defenseUrls.includes($.drawApiPath) && (I11II1.body = JSON.stringify({
              ecyText: iII1l1({
                actId: $.activityId,
                activityId: $.activityId,
                pin: encodeURIComponent(lIIlI1)
              }, ilill1, iIIiI1)
            }));
            i1l111 = lIIIli + " Êé•Âè£Êó†ÂìçÂ∫îÊï∞ÊçÆ";
            i1iIII++;
          }
        }
      }
      if (i1iIII >= l1II) {
        Ili11.fix(i1l111);
        if (!["getGiveContent", "shopInfo", "accessLogWithAD", "accessLog"].includes(lIIIli)) {
          Ili11.fix(i1l111);
        }
      }
    }
    async function lI1i1() {
      return new Promise(i1llIl => {
        let il1ii1 = {
          url: $.activityUrl,
          headers: {
            Accept: "application/json, text/plain, */*",
            "Accept-Encoding": "gzip, deflate, br",
            "Accept-Language": "zh-cn",
            Connection: "keep-alive",
            "Content-Type": "application/x-www-form-urlencoded",
            Referer: $.activityUrl,
            "User-Agent": I1IiII
          },
          timeout: 30000
        };
        $.get(il1ii1, (IIII1, iIi1, I11IIl) => {
          try {
            iIi1.status === 200 ? i1llIl(li1lIl.getResponseCookie(iIi1, l1i1lI)) : i1llIl(null);
          } catch (Il11li) {
            i1llIl(null);
          }
        });
      });
    }
  });
  console.log("\nÂπ∂ÂèëËøêË°åÂÆåÊØï");
}
async function il11lI(lil1l1, I1i1ll) {
  try {
    switch (lil1l1) {
      case "getMyPing":
        if (I1i1ll.result === true && I1i1ll.data) {
          $.secretPin = I1i1ll.data?.["secretPin"];
          $.nickname = I1i1ll.data?.["nickname"];
        } else {
          I1i1ll.errorMessage ? (console.log(lil1l1 + " " + I1i1ll.errorMessage), $.message.fix(I1i1ll.errorMessage)) : console.log("‚ùì" + lil1l1 + " " + JSON.stringify(I1i1ll));
        }
        break;
      case "initPinToken":
        if (I1i1ll.result === true && I1i1ll.data) {
          $.secretPin = I1i1ll.data?.["secretPin"];
          $.nickname = I1i1ll.data?.["nickname"];
        } else {
          I1i1ll.errorMessage ? (console.log(lil1l1 + " " + I1i1ll.errorMessage), $.message.fix(I1i1ll.errorMessage)) : console.log("‚ùì" + lil1l1 + " " + JSON.stringify(I1i1ll));
        }
        break;
      case "getSimpleActInfoVo":
        if (I1i1ll.result === true && I1i1ll.data) {
          $.venderId = I1i1ll.data?.["venderId"];
          $.shopId = I1i1ll.data?.["shopId"];
          $.activityType = I1i1ll.data?.["activityType"];
        } else {
          I1i1ll.errorMessage ? console.log(lil1l1 + " " + I1i1ll.errorMessage) : console.log("‚ùì" + lil1l1 + " " + JSON.stringify(I1i1ll));
        }
        break;
      case "getDefenseUrls":
        if (I1i1ll.result === true && I1i1ll.data) {
          $.defenseUrls = I1i1ll?.["data"];
        } else {
          I1i1ll.errorMessage ? console.log(lil1l1 + " " + I1i1ll.errorMessage) : console.log("‚ùì" + lil1l1 + " " + JSON.stringify(I1i1ll));
        }
      case "getOpenCardStatus":
        if (I1i1ll.result === true) {
          if (I1i1ll.data) {
            if (I1i1ll.data.hasOwnProperty("openCard")) {
              $.isMember = I1i1ll.data.openCard;
            } else {
              I1i1ll.data.hasOwnProperty("openedCard") && ($.isMember = I1i1ll.data.openedCard);
            }
            if (typeof $.isMember === "number") {
              $.isMember = $.isMember === 1;
            } else {
              if (typeof $.isMember === "undefined") {
                $.isMember = false;
              }
            }
          } else {
            $.isMember = true;
          }
        } else {
          I1i1ll.errorMessage ? I1i1ll.errorMessage.includes("Êì¶ËÇ©") && !I1i1ll?.["data"] ? ($.skipRun = true, $.message.fix("Ë¥¶Âè∑Â∑≤Èªë"), console.log("Ë¥¶Âè∑Â∑≤ÈªëÔºå‰∏ãÊ¨°Âà´Ë∑ë‰∫Ü~")) : console.log(lil1l1 + " " + I1i1ll.errorMessage) : ($.isMember = false, console.log("‚ùì" + lil1l1 + " " + JSON.stringify(I1i1ll)));
        }
        break;
      case "activityContent":
        if (I1i1ll.result === true && I1i1ll.data) {
          $.activityContent = I1i1ll.data;
        } else {
          if (I1i1ll.errorMessage) {
            for (let iIli of ["Êú™ÂºÄÂßã", "ÁªìÊùü", "‰∏çÂ≠òÂú®", "‰∏çÂú®"]) {
              if (I1i1ll.errorMessage.includes(iIli)) {
                $.runEnd = true;
                break;
              }
            }
            console.log(lil1l1 + " " + I1i1ll.errorMessage);
            $.message.fix(I1i1ll.errorMessage);
          } else {
            console.log("‚ùì" + lil1l1 + " " + JSON.stringify(I1i1ll));
          }
        }
        break;
      case "shopInfo":
        if (I1i1ll.result === true && I1i1ll.data) {
          $.shopName = I1i1ll?.["data"]?.["shopName"];
        } else {
          I1i1ll.errorMessage ? console.log("" + (I1i1ll.errorMessage || "")) : console.log("‚ùì" + lil1l1 + " " + JSON.stringify(I1i1ll));
        }
        break;
      case "followShop":
        if (!(I1i1ll.result === true)) {
          I1i1ll.errorMessage ? (["‰ºöÂëò", "ÂºÄÂç°"].some(iIi1l1 => I1i1ll.errorMessage.includes(iIi1l1)) && ($.needJoinMember = true, $.message.fix("Ê¥ªÂä®‰ªÖÈôêÂ∫óÈì∫‰ºöÂëòÂèÇ‰∏é")), console.log("" + (I1i1ll.errorMessage || ""))) : console.log("‚ùì" + lil1l1 + " " + JSON.stringify(I1i1ll));
        }
        break;
      case "getGiveContent":
        if (I1i1ll.result === true && I1i1ll.data) {
          $.followTaskInfo = I1i1ll.data?.["follow"];
        } else {
          I1i1ll.errorMessage ? console.log("" + (I1i1ll.errorMessage || "")) : console.log("‚ùì" + lil1l1 + " " + JSON.stringify(I1i1ll));
        }
        break;
      case "followGoods":
        if (I1i1ll.result === true) {
          console.log("ÂÅö \"ÂÖ≥Ê≥®ÂïÜÂìÅ\" ‰ªªÂä° >> ‰ªªÂä°ÂÆåÊàê");
        } else {
          I1i1ll.errorMessage ? console.log("ÂÅö \"ÂÖ≥Ê≥®ÂïÜÂìÅ\" ‰ªªÂä° >> ‰ªªÂä°Â§±Ë¥•Ôºà" + I1i1ll.errorMessage + "Ôºâ") : console.log("‚ùì" + lil1l1 + " " + JSON.stringify(I1i1ll));
        }
        break;
      case "start":
        if (I1i1ll.result === true && I1i1ll.data) {
          llllli = false;
          $.drawTimes += 1;
          $.canDrawTimes = I1i1ll.data.canDrawTimes;
          const li1iil = I1i1ll.data.drawInfo;
          if (li1iil) {
            switch (li1iil.type) {
              case 4:
                switch ($.activityType) {
                  case 3:
                  case 4:
                  case 11:
                  case 12:
                  case 13:
                    console.log("üîÅ ÂÜçÊù•‰∏ÄÊ¨°");
                    $.canDrawTimes += 1;
                    break;
                  case 26:
                  case 124:
                  case 125:
                  case 128:
                  case 129:
                    console.log("üí® Á©∫Ê∞î");
                    $.message.insert("Á©∫Ê∞îüí®");
                    break;
                }
                break;
              case 6:
                console.log("üéâ " + li1iil.name + " üê∂");
                $.message.insert(li1iil.name + "üê∂");
                break;
              case 7:
                const i1iI1l = I1i1ll.data.addressId,
                  i1lIIi = li1iil.name;
                console.log("üéâ ÊÅ≠ÂñúËé∑ÂæóÂÆûÁâ©~");
                console.log("Â•ñÂìÅÂêçÁß∞Ôºö" + i1lIIi);
                console.log("ÂèÇËÄÉ‰ª∑ÂÄºÔºö" + li1iil.priceInfo + "ÔºàÂÖÉÔºâ");
                if (li1iil.showImage) {
                  console.log("È¢ÑËßàÂõæÁâáÔºö" + li1iil.showImage);
                }
                const llil1i = {
                    baseUrl: $.baseUrl,
                    cookie: Ii11iI,
                    ua: $.UA,
                    activityId: $.activityId,
                    activityType: $.activityType,
                    venderId: [$.venderId, $.shopId],
                    secretPin: $.secretPin,
                    prizeName: i1lIIi,
                    generateId: i1iI1l
                  },
                  IililI = await iilill(llil1i);
                !Il1lIi && IililI && (await li1lIi.sendNotify($.name + "‰∏≠Â•ñÈÄöÁü•", "„Äê‰∫¨‰∏úË¥¶Âè∑" + $.index + "„Äë" + $.nickName + "\nÊäΩ‰∏≠ÂÆûÁâ© " + i1lIIi + "ÔºåÂ∑≤ÊàêÂäüËá™Âä®ÁôªËÆ∞Êî∂Ë¥ßÂú∞ÂùÄ\n\n" + $.activityUrl));
                $.message.insert(i1lIIi + "(" + (IililI ? "Â∑≤Â°´Âú∞ÂùÄ" : "Êú™Â°´Âú∞ÂùÄ") + ")üéÅ");
                break;
              case 8:
                console.log("üóëÔ∏è ‰∏ì‰∫´‰ª∑");
                $.message.insert("‰∏ì‰∫´‰ª∑üóëÔ∏è");
                break;
              case 9:
                console.log("üóëÔ∏è " + li1iil.name + " üéüÔ∏è");
                $.message.insert(li1iil.name + "üéüÔ∏è");
                break;
              case 13:
              case 14:
              case 15:
                console.log("üéâ ÊÅ≠ÂñúËé∑Âæó" + li1iil.name + " üéÅ");
                !Il1lIi && (await li1lIi.sendNotify($.name + "‰∏≠Â•ñÈÄöÁü•", "„Äê‰∫¨‰∏úË¥¶Âè∑" + $.index + "„Äë" + $.nickName + "\nÊäΩ‰∏≠ " + li1iil.name + "\n\n" + $.activityUrl));
                $.message.insert(li1iil.name + "üéÅ");
                break;
              case 16:
                console.log("üéâ " + li1iil.priceInfo + " üßß");
                $.message.insert(li1iil.priceInfo + "Á∫¢ÂåÖüßß");
                break;
              default:
                if (li1iil.name.includes("Âà∏")) {
                  console.log("üóëÔ∏è ‰ºòÊÉ†Âà∏");
                  $.message.insert("‰ºòÊÉ†Âà∏üóëÔ∏è");
                } else {
                  console.log("Ëé∑ÂæóÔºö" + li1iil.name);
                  $.message.insert("" + li1iil.name);
                }
                break;
            }
          } else {
            $.drawMissTimes += 1;
            console.log("üí® Á©∫Ê∞î");
            $.message.insert("Á©∫Ê∞îüí®");
          }
        } else {
          I1i1ll.errorMessage ? ($.drawError = I1i1ll.errorMessage, ["‰∏äÈôê", "‰∏çË∂≥", "Ë∂ÖËøá", "ÈùûÊ≥ïÊìç‰Ωú", "ÊòéÂ§©"].some(ilIi1I => $.drawError.includes(ilIi1I)) && ($.drawStop = true, console.log($.drawError), $.message.insert($.drawError)), ["Êú™ÂºÄÂßã", "ÁªìÊùü", "‰∏çÂ≠òÂú®", "‰∏çÂú®"].some(II1l1I => $.drawError.includes(II1l1I)) && ($.runEnd = true, $.message.fix($.drawError)), ["‰ºöÂëò", "ÂºÄÂç°"].some(iiIii1 => $.drawError.includes(iiIii1)) && ($.needJoinMember = true, console.log($.drawError), $.message.fix($.drawError)), !["ÁÅ´ÁàÜ", "Êì¶ËÇ©", "ÁºìÂ≠ò", "Êï∞ÊçÆÂøô"].some(li1iii => $.drawError.includes(li1iii)) && !$.drawStop && !$.needJoinMember && console.log($.drawError || "")) : console.log("‚ùì" + lil1l1 + " " + JSON.stringify(I1i1ll));
        }
        break;
    }
  } catch (ll1i1i) {
    console.log("‚ùå Êú™ËÉΩÊ≠£Á°ÆÂ§ÑÁêÜ " + lil1l1 + " ËØ∑Ê±ÇÂìçÂ∫î " + (ll1i1i.message || ll1i1i));
  }
}
async function lIll1I(ll1i1l) {
  if ($.runEnd || $.outFlag) {
    return;
  }
  let iIi1il = "",
    iIi1ii = "",
    i11i1l = "POST";
  switch (ll1i1l) {
    case "getMyPing":
      iIi1il = $.baseUrl + "/customer/getMyPing";
      iIi1ii = "token=" + $.token + "&fromType=APP&userId=" + $.venderId;
      break;
    case "getSimpleActInfoVo":
      iIi1il = $.baseUrl + "/customer/getSimpleActInfoVo";
      iIi1ii = "activityId=" + $.activityId;
      break;
    case "getDefenseUrls":
      i11i1l = "GET";
      iIi1il = $.baseUrl + "/customer/getDefenseUrls";
      break;
    case "initPinToken":
      i11i1l = "GET";
      iIi1il = $.baseUrl + "/customer/initPinToken?status=1&activityId=" + $.activityId + "&jdToken=" + $.token + "&source=01&venderId=" + $.venderId + "&uuid=" + $.UUID + "&clientTime=" + Date.now();
      break;
    case "accessLog":
      iIi1il = $.baseUrl + "/common/accessLog";
      iIi1ii = "venderId=" + $.venderId + "&code=" + $.activityType + "&pin=" + $.formatPin + "&activityId=" + $.activityId + "&pageUrl=" + encodeURIComponent($.activityUrl) + "&subType=app&adSource=";
      break;
    case "accessLogWithAD":
      iIi1il = $.baseUrl + "/common/accessLogWithAD";
      iIi1ii = "venderId=" + $.venderId + "&code=" + $.activityType + "&pin=" + $.formatPin + "&activityId=" + $.activityId + "&pageUrl=" + encodeURIComponent($.activityUrl) + "&subType=app";
      break;
    case "getOpenCardStatus":
      switch ($.activityType) {
        case 3:
        case 4:
        case 11:
        case 12:
        case 13:
          switch ($.activityMode) {
            case "lzkj":
              iIi1il = $.baseUrl + "/wxCommonInfo/getActMemberInfo";
              iIi1ii = "activityId=" + $.activityId + "&venderId=" + $.venderId + "&pin=" + $.formatPin;
              break;
            case "cjhy":
              iIi1il = $.baseUrl + "/mc/new/brandCard/common/shopAndBrand/getOpenCardInfo";
              iIi1ii = "venderId=" + $.venderId + "&buyerPin=" + $.formatPin + "&activityType=" + $.activityType;
              break;
          }
          break;
        case 26:
          switch ($.activityMode) {
            case "lzkj":
              iIi1il = $.baseUrl + "/crmCard/common/coupon/getOpenCardStatus";
              iIi1ii = "venderId=" + $.venderId + "&pin=" + $.formatPin;
              break;
            case "cjhy":
              iIi1il = $.baseUrl + "/common/joinConfig/check";
              iIi1ii = "venderId=" + $.venderId + "&pin=" + $.formatPin + "&activityType=" + $.activityType + "&activityId=" + $.activityId;
              break;
          }
          break;
        case 124:
        case 125:
        case 128:
        case 129:
          iIi1il = $.baseUrl + "/common/joinConfig/check";
          iIi1ii = "venderId=" + $.venderId + "&pin=" + $.formatPin + "&activityType=" + $.activityType + "&activityId=" + $.activityId;
          break;
      }
      break;
    case "activityContent":
      let I11i1 = "";
      switch ($.activityType) {
        case 3:
        case 4:
        case 11:
        case 12:
        case 13:
          I11i1 = "wxDrawActivity/activityContent";
          break;
        case 26:
          I11i1 = "wxPointDrawActivity/activityContent";
          break;
        case 124:
          I11i1 = "wxScratchActive/activityContent";
          break;
        case 125:
          I11i1 = "wxPointBlindBox/activityContent";
          break;
        case 128:
          I11i1 = "wxGashaponActive/activityContent";
          break;
        case 129:
          I11i1 = "wxDollGrabbing/activityContent";
          break;
      }
      iIi1il = $.baseUrl + "/" + I11i1;
      iIi1ii = "activityId=" + $.activityId + "&pin=" + $.formatPin;
      break;
    case "shopInfo":
      iIi1il = $.baseUrl + "/wxDrawActivity/shopInfo";
      iIi1ii = "activityId=" + $.activityId;
      break;
    case "followShop":
      switch ($.activityMode) {
        case "lzkj":
          iIi1il = $.baseUrl + "/wxActionCommon/followShop";
          iIi1ii = "userId=" + $.venderId + "&buyerNick=" + $.formatPin + "&activityId=" + $.activityId + "&activityType=" + $.activityType;
          break;
        case "cjhy":
          iIi1il = $.baseUrl + "/wxActionCommon/newFollowShop";
          iIi1ii = "venderId=" + $.venderId + "&buyerPin=" + $.formatPin + "&activityId=" + $.activityId + "&activityType=" + $.activityType;
          break;
      }
      break;
    case "getGiveContent":
      iIi1il = $.baseUrl + "/wxDrawActivity/getGiveContent";
      iIi1ii = "pin=" + $.formatPin + "&activityId=" + $.activityId;
      break;
    case "followGoods":
      iIi1il = $.baseUrl + "/wxDrawActivity/follow";
      iIi1ii = "activityId=" + $.activityId + "&pin=" + $.formatPin + "&skuId=" + $.skuId;
      break;
    case "start":
      iIi1il = "" + $.baseUrl + $.drawApiPath;
      $.defenseUrls && $.defenseUrls.includes($.drawApiPath) ? iIi1ii = JSON.stringify({
        ecyText: iII1l1({
          actId: $.activityId,
          activityId: $.activityId,
          pin: encodeURIComponent($.secretPin)
        }, $.pinToken, $.te)
      }) : iIi1ii = "activityId=" + $.activityId + "&pin=" + $.formatPin;
      break;
    default:
      console.log("‚ùå Êú™Áü•ËØ∑Ê±Ç " + ll1i1l);
      return;
  }
  const iIlI = {
    url: iIi1il,
    headers: {
      Origin: $.origin,
      Accept: "application/json",
      "Accept-Encoding": "gzip, deflate, br",
      "Accept-Language": "zh-CN,zh;q=0.9",
      Connection: "keep-alive",
      "Content-Type": ll1i1l === "start" && $.defenseUrls && $.defenseUrls.includes($.drawApiPath) ? "application/json" : "application/x-www-form-urlencoded",
      Cookie: Ii11iI.trim(),
      "Sec-Fetch-Dest": "empty",
      "Sec-Fetch-Mode": "cors",
      "Sec-Fetch-Site": "same-origin",
      "User-Agent": $.UA,
      "X-Requested-With": "XMLHttpRequest",
      Referer: $.activityUrl
    },
    body: iIi1ii,
    timeout: 30000
  };
  i11i1l === "GET" && (delete iIlI.body, delete iIlI.headers["Content-Type"]);
  const llil11 = 5;
  let i11i1i = 0,
    Iilill = null,
    iIl1 = false;
  while (i11i1i < llil11) {
    if (i11i1i > 0) {
      await $.wait(1000);
    }
    const {
      err: II1II1,
      res: llli,
      data: i1ll1l
    } = await li1II1(iIlI, i11i1l);
    if (II1II1) {
      if (typeof II1II1 === "string" && II1II1.includes("Timeout awaiting 'request'")) {
        Iilill = ll1i1l + " ËØ∑Ê±ÇË∂ÖÊó∂ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúÈáçËØï";
      } else {
        const II1III = llli?.["statusCode"];
        if (II1III) {
          if ([403, 493].includes(II1III)) {
            Iilill = ll1i1l + " ËØ∑Ê±ÇÂ§±Ë¥•ÔºåIPË¢´ÈôêÂà∂ÔºàResponse code " + II1III + "Ôºâ";
            iIl1 = true;
          } else {
            if ([400, 404].includes(II1III)) {
              Iilill = ll1i1l + " ËØ∑Ê±ÇÈÖçÁΩÆÂèÇÊï∞ÈîôËØØÔºåËØ∑ËÅîÁ≥ªÂºÄÂèëËÄÖËøõË°åÂèçÈ¶àÔºàResponse code " + II1III + "Ôºâ";
            } else {
              if ([500].includes(II1III) && ll1i1l === "start" && $.activityMode === "cjhy" && $.defenseUrls && $.defenseUrls.includes($.drawApiPath)) {
                iIlI.body = JSON.stringify({
                  ecyText: iII1l1({
                    actId: $.activityId,
                    activityId: $.activityId,
                    pin: encodeURIComponent($.secretPin)
                  }, $.pinToken, $.te)
                });
              } else {
                Iilill = ll1i1l + " ËØ∑Ê±ÇÂ§±Ë¥•ÔºàResponse code " + II1III + "Ôºâ";
              }
            }
          }
        } else {
          Iilill = ll1i1l + " ËØ∑Ê±ÇÂ§±Ë¥• => " + (II1II1.message || II1II1);
        }
      }
      i11i1i++;
    } else {
      const liill1 = li1lIl.getResponseCookie(llli, Ii11iI),
        ili1ii = false;
      ili1ii && (console.log("\n---------------------------------------------------\n"), console.log("üîß " + ll1i1l + " ÂìçÂ∫îBody => " + (i1ll1l || "Êó†") + "\n"), console.log("üîß " + ll1i1l + " ÂìçÂ∫îCookie => " + (liill1 || "Êó†") + "\n"), console.log("üîß " + ll1i1l + " ËØ∑Ê±ÇÂèÇÊï∞"), console.log(iIlI), console.log("\n---------------------------------------------------\n"));
      let Il1lii = "";
      switch (ll1i1l) {
        case "getMyPing":
          Il1lii = li1lIl.getCookieValue(liill1, "LZ_AES_PIN");
          if (Il1lii) {
            $.LZ_AES_PIN = Il1lii;
          } else {
            console.log("Ëé∑Âèñ LZ_AES_PIN Â§±Ë¥•ÔºÅ");
            $.message.fix("Ëé∑Âèñ[LZ_AES_PIN]Â§±Ë¥•");
            $.skipRun = true;
          }
          break;
        case "initPinToken":
          const Illi1i = li1lIl.getCookieValue(liill1, "pToken");
          if (Illi1i) {
            $.pinToken = Illi1i;
          } else {
            console.log("Ëé∑Âèñ pinToken Â§±Ë¥•ÔºÅ");
            $.message.fix("Ëé∑Âèñ[pinToken]Â§±Ë¥•");
            $.skipRun = true;
            break;
          }
          Il1lii = li1lIl.getCookieValue(liill1, "LZ_AES_PIN");
          if (Il1lii) {
            $.LZ_AES_PIN = Il1lii;
          } else {
            console.log("Ëé∑Âèñ LZ_AES_PIN Â§±Ë¥•ÔºÅ");
            $.message.fix("Ëé∑Âèñ[LZ_AES_PIN]Â§±Ë¥•");
            $.skipRun = true;
            break;
          }
          const lllI = li1lIl.getCookieValue(liill1, "te");
          lllI && ($.te = lllI, Ii11iI += "te=" + $.te + "; ");
          break;
      }
      ["getMyPing", "followGoods", "start"].includes(ll1i1l) && (Ii11iI = liill1);
      Il1lii = li1lIl.getCookieValue(Ii11iI, "LZ_AES_PIN");
      !Il1lii && $.LZ_AES_PIN && (Ii11iI += "LZ_AES_PIN=" + $.LZ_AES_PIN + "; ");
      const Iilii1 = li1lIl.getCookieValue(Ii11iI, "pToken");
      !Iilii1 && $.pinToken && (Ii11iI += "pToken=" + $.pinToken + "; ");
      const lllIi1 = li1lIl.getCookieValue(Ii11iI, "AUTH_C_USER");
      !lllIi1 && $.secretPin && (Ii11iI += "AUTH_C_USER=" + $.secretPin + "; ");
      const Illi1l = li1lIl.getCookieValue(Ii11iI, "te");
      !Illi1l && $.te && (Ii11iI += "te=" + $.te + "; ");
      if (!["accessLog", "accessLogWithAD"].includes(ll1i1l)) {
        if (i1ll1l) {
          try {
            const lIlilI = JSON.parse(i1ll1l);
            il11lI(ll1i1l, lIlilI);
            break;
          } catch (lll1) {
            Iilill = "‚ùå " + ll1i1l + " Êé•Âè£ÂìçÂ∫îÊï∞ÊçÆËß£ÊûêÂ§±Ë¥•: " + lll1.message;
            console.log("üö´ " + ll1i1l + " => " + String(i1ll1l));
            ili1ii && (console.log("\n---------------------------------------------------\n"), console.log(Ii11iI), console.log("\n---------------------------------------------------\n"));
            i11i1i++;
          }
        } else {
          ll1i1l === "start" && $.activityMode === "cjhy" && $.defenseUrls && $.defenseUrls.includes($.drawApiPath) && (iIlI.body = JSON.stringify({
            ecyText: iII1l1({
              actId: $.activityId,
              activityId: $.activityId,
              pin: encodeURIComponent($.secretPin)
            }, $.pinToken, $.te)
          }));
          Iilill = "‚ùå " + ll1i1l + " Êé•Âè£Êó†ÂìçÂ∫îÊï∞ÊçÆ";
          i11i1i++;
        }
      } else {
        break;
      }
      iIl1 = false;
    }
  }
  if (i11i1i >= llil11) {
    console.log(Iilill);
    if (iIl1 && !["getGiveContent", "shopInfo", "accessLogWithAD", "accessLog"].includes(ll1i1l)) {
      !l1IIIi && ($.outFlag = true, $.message && $.message.fix(Iilill));
    }
  }
}
async function li1II1(li1ill, il1I1l = "POST") {
  if (il1I1l === "POST") {
    return new Promise(async IliII => {
      $.post(li1ill, (i1I1ii, I11ii, i1I1il) => {
        IliII({
          err: i1I1ii,
          res: I11ii,
          data: i1I1il
        });
      });
    });
  } else {
    if (il1I1l === "GET") {
      return new Promise(async IiI1II => {
        $.get(li1ill, (Iii1I, I11il, IIIiIi) => {
          IiI1II({
            err: Iii1I,
            res: I11il,
            data: IIIiIi
          });
        });
      });
    } else {
      const IIIiIl = "‰∏çÊîØÊåÅÁöÑËØ∑Ê±ÇÊñπÊ≥ï";
      return {
        err: IIIiIl,
        res: null,
        data: null
      };
    }
  }
}
function iiIllI(illli) {
  $.skipRun = true;
  return new Promise(iIIi1I => {
    let llll = {
      url: illli,
      headers: {
        Accept: "application/json, text/plain, */*",
        "Accept-Encoding": "gzip, deflate, br",
        "Accept-Language": "zh-cn",
        Connection: "keep-alive",
        "Content-Type": "application/x-www-form-urlencoded",
        Referer: illli,
        "User-Agent": $.UA
      },
      timeout: 30000
    };
    $.get(llll, async (ii1Ii1, i1I1lI, IIl) => {
      try {
        if (ii1Ii1) {
          if (i1I1lI && typeof i1I1lI.statusCode != "undefined") {
            if (i1I1lI.statusCode === 493) {
              console.log("Ê≠§ipÂ∑≤Ë¢´ÈôêÂà∂ÔºåËØ∑Ëøá10ÂàÜÈíüÂêéÂÜçÊâßË°åËÑöÊú¨ÔºÅ");
              !l1IIIi && ($.outFlag = true);
            }
          }
          console.log(String(ii1Ii1));
          console.log("getFirstLZCK ËØ∑Ê±ÇÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëË∑ØÈáçËØï");
        } else {
          IIl.match(/(Ê¥ªÂä®Â∑≤ÁªèÁªìÊùü)/) && IIl.match(/(Ê¥ªÂä®Â∑≤ÁªèÁªìÊùü)/)[1] && ($.runEnd = true, console.log("Ê¥ªÂä®Â∑≤ÁªìÊùüÊàñ‰∏çÂ≠òÂú®"));
          i1I1lI.status === 200 && (Ii11iI = li1lIl.getResponseCookie(i1I1lI, Ii11iI), $.skipRun = false);
        }
      } catch (I11lI) {
        $.logErr(I11lI, i1I1lI);
      } finally {
        iIIi1I();
      }
    });
  });
}
function iII1l1(l1l1ll, l1ilii, l1l1li) {
  function l11ilI(l1111I) {
    l1111I = l1111I.split("").reverse().join("");
    const iI1I11 = new Uint8Array(12),
      l11111 = new TextEncoder().encode(l1111I);
    for (let i1II = 0; i1II < l11111.length; i1II += 2) {
      let iI1I1I = l11111[i1II] << 5 | l11111[i1II + 1] & 255;
      iI1I1I %= 63;
      iI1I11[i1II >> 1] = iI1I1I;
    }
    let I1111 = "";
    for (let I11I11 = 0; I11I11 < iI1I11.length; I11I11++) {
      I1111 += (iI1I11[I11I11] + 256).toString(2).slice(1);
    }
    let i1Ii = "",
      i1Il = "";
    for (let il1l1I = 0; il1l1I < 16; il1l1I++) {
      if (il1l1I !== 0) {
        const i1Ili1 = il1l1I * 6,
          l1111l = I1111.substring(i1Ili1, i1Ili1 + 6);
        let llI1ll = parseInt(l1111l, 2);
        const I111i = i1Il.split("");
        for (let iili11 = 0; iili11 < I111i.length; iili11++) {
          I111i[iili11] === "1" && (llI1ll = (llI1ll >> 6 - iili11 | llI1ll << iili11) & 63);
        }
        i1Il = (llI1ll & 63).toString(2).padStart(6, "0");
      } else {
        i1Il = I1111.substring(0, 6);
      }
      i1Ii += i1Il;
    }
    for (let I111l = 0; I111l < 12; I111l++) {
      const il1l11 = I111l * 8;
      iI1I11[I111l] = parseInt(i1Ii.substring(il1l11, il1l11 + 8), 2);
    }
    const llilI = btoa(String.fromCharCode.apply(null, iI1I11));
    return llilI;
  }
  const ii1Iil = ["B6dB3QqGZP1lKNICTaiAeNJSHKNepO5GGgtL6FUceqSlpFZCdx2SZ5MPPbzrgy91HeR0dnJazcMrvMgPF7bhFrfsGaApJKk4JohEEhoJ4kKJpAaGsfrFhb7FPgMvrMczaJnd0ReH19ygrzbPPM5ZS2xdCZFplSqecUF6LtgGG5OpeNKHSJNeAiaTCINKl1PZGqQ3Bd6B", "EUhzJoyKP7VydtpyBwNUGU2tqzI0QB0LIpQ10Fk3hX2ZcPoGRpACqmzcTQbKd98i3U7raFz2rMl2kys0ODgtAh22E3i57wmh38RbbR83hmw75i3E22hAtgDO0syk2lMr2zFar7U3i89dKbQTczmqCApRGoPcZ2Xh3kF01QpIL0BQ0Izqt2UGUNwByptdyV7PKyoJzhUE", "xexcHoyVwOs5TYTQVvU0iXn56ryKVdWedLTpq3KEKmbUHfwzuZjIpZOPVXMEappFhjdqwtp1bBrWaRBCfPFwCq2W8SsyvwqZ6sIGGIs6ZqwvysS8W2qCwFPfCBRaWrBb1ptwqdjhFppaEMXVPOZpIjZuzwfHUbmKEK3qpTLdeWdVKyr65nXi0UvVQTYT5sOwVyoHcxex", "2Llnegc5i4flqd4HZPFK210yh61boBxRSdnNVMeudKimx92Qi4aPuHP12HmEImbWrXjLgBGqy1bSnKvLhqMqhknyuse4nFoeLTkJJkTLeoFn4esuynkhqMqhLvKnSb1yqGBgLjXrWbmIEmH21PHuPa4iQ29xmiKdueMVNndSRxBob16hy012KFPZH4dqlf4i5cgenlL2", "dZzoMZF6xtt3voTFDbPzEZ7GeM8t7uY05d4K4xfhtdxELh96dDRB4oRYA2smET5dy1dafGkXOz2V7tNOVi0vSqfuhI99IKprVK6QQ6KVrpKI99IhufqSv0iVONt7V2zOXkGfad1yd5TEms2AYRo4BRDd69hLExdthfx4K4d50Yu7t8MeG7ZEzPbDFTov3ttx6FZMozZd", "SNYr3bWMtQulWZO2FEwuhSFp3EXPR1TujPRJwUFlxBh9Pvf2MeTEpR7a3dU6e9rNUMyBh2osDdK4Vdm4gZ0XcRCoHZPi2jiXT2dCCd2TXij2iPZHoCRcX0Zg4mdV4KdDso2hByMUNr9e6Ud3a7RpETeM2fvP9hBxlFUwJRPjuT1RPXE3pFShuwEF2OZWluQtMWb3rYNS", "4viQ2FrYHcrH44gqvPLo6KtiFu56AW1eXbDBZrBepzdLKE33Ey4TwFERnkVLnbHAXbKqAi0HFP9Eu7yg8WNlI7q2dvXGGiPaMbrBBrbMaPiGGXvd2q7IlNW8gy7uE9PFH0iAqKbXAHbnLVknREFwT4yE33EKLdzpeBrZBDbXe1WA65uFitK6oLPvqg44HrcHYrF2Qiv4", "0VIoSHBNVAW8De7NquFyEUm0o9xNnQJGn2OR1yOK9djWALhyP3a1XoQEwTnXuzypRuwsaLPUlertksOY6LYmnbQmPgdDQRXXKdKooKdKXXRQDdgPmQbnmYL6YOsktrelUPLaswuRpyzuXnTwEQoX1a3PyhLAWjd9KOy1RO2nGJQnNx9o0mUEyFuqN7eD8WAVNBHSoIV0", "fdJPBiTra9E0qg2HJrobeEC2SkOfSzbw6nG5J5ACx42GQDBsCyGfxNlHHYhl7EmkdvYaKAXUVXSKcTT1KhyYaj9Q4YtyhnOA7cLrrLc7AOnhytY4Q9jaYyhK1TTcKSXVUXAKaYvdkmE7lhYHHlNxfGyCsBDQG24xCA5J5Gn6wbzSfOkS2CEeborJH2gq0E9arTiBPJdf", "kLOA93PyUOX3QdlLuZ9JgNq1peyIITAQSnKzuLBZ2NthOSseAJMGCecvSLVKAww61Y31hJ4l7kAOcjLmtqQNJlNyJb5yu9d9vqWUUWqv9d9uy5bJyNlJNQqtmLjcOAk7l4Jh13Y16wwAKVLSvceCGMJAesSOhtN2ZBLuzKnSQATIIyep1qNgJ9ZuLldQ3XOUyP39AOLk"];
  let Iii1l = Date.now() + parseInt(l1l1li);
  typeof l1l1ll != "object" && (l1l1ll = JSON.parse(l1l1ll));
  l1l1ll.nowTime = Iii1l;
  let IliIi = l1ilii + Iii1l;
  const i1I1ll = IliIi.substring(0, IliIi.length - 5);
  let I11ll = "";
  for (let i1IliI = 0; i1IliI < i1I1ll.length; i1IliI++) {
    let I1lII = i1I1ll.charCodeAt(i1IliI),
      iili1l = I1lII % 10,
      il1l1i = ii1Iil[iili1l][i1IliI];
    I11ll += il1l1i;
  }
  var lllIll = I11ll.length,
    illii = Math.floor(lllIll / 24),
    ii1Iii = "";
  for (var Iii1i = 0; Iii1i < 24; Iii1i++) {
    var lllIli = (Iii1i + 1) * illii;
    Iii1i === 23 && (lllIli = lllIll);
    var lII1II = I11ll.substring(Iii1i * illii, lllIli);
    var IliIl = [];
    for (var illil = 0; illil < lII1II.length; illil++) {
      IliIl.push(lII1II.charCodeAt(illil));
    }
    var I11li = IliIl.reduce(function (IlIIii, lI1Ii) {
      return IlIIii + lI1Ii;
    }, 0);
    var l11il1 = Math.floor(I11li / IliIl.length);
    ii1Iii += String.fromCharCode(l11il1);
  }
  I11ll = ii1Iii;
  const li1I11 = l11ilI(I11ll),
    I1i1iI = IiIIii.enc.Utf8.parse(li1I11),
    liI1I = IiIIii.enc.Utf8.parse(""),
    l1illl = IiIIii.AES.encrypt(JSON.stringify(l1l1ll), I1i1iI, {
      iv: liI1I,
      mode: IiIIii.mode.ECB,
      padding: IiIIii.pad.Pkcs7
    });
  return l1illl.toString();
}
function I1I1I() {
  if ($.blacklist == "") {
    return;
  }
  console.log("ÂΩìÂâçÂ∑≤ËÆæÁΩÆÈªëÂêçÂçïÔºö");
  const lii1I1 = Array.from(new Set($.blacklist.split("&")));
  console.log(lii1I1.join("&") + "\n");
  let il1l1l = lii1I1,
    ii1li1 = [],
    iili1I = false;
  for (let I11I1l = 0; I11I1l < lIiili.length; I11I1l++) {
    let I11I1i = decodeURIComponent(lIiili[I11I1l].match(/pt_pin=([^; ]+)(?=;?)/) && lIiili[I11I1l].match(/pt_pin=([^; ]+)(?=;?)/)[1] || "");
    if (!I11I1i) {
      break;
    }
    let llI1i = false;
    for (let IlIIli of il1l1l) {
      if (IlIIli && IlIIli == I11I1i) {
        llI1i = true;
        break;
      }
    }
    !llI1i && (iili1I = true, ii1li1.splice(I11I1l, -1, lIiili[I11I1l]));
  }
  if (iili1I) {
    lIiili = ii1li1;
  }
}
function l1IIII(i1IllI, ii1lil) {
  ii1lil != 0 && i1IllI.unshift(i1IllI.splice(ii1lil, 1)[0]);
}
function IIillI() {
  if ($.whitelist == "") {
    helpCookiesArr = $.toObj($.toStr(lIiili, lIiili));
    return;
  }
  console.log("ÂΩìÂâçÂ∑≤ËÆæÁΩÆÁôΩÂêçÂçïÔºö");
  const l11IiI = Array.from(new Set($.whitelist.split("&")));
  console.log(l11IiI.join("&") + "\n");
  let i1Illl = [],
    i1Illi = l11IiI;
  for (let I1iliI in lIiili) {
    let I1ili1 = decodeURIComponent(lIiili[I1iliI].match(/pt_pin=([^; ]+)(?=;?)/) && lIiili[I1iliI].match(/pt_pin=([^; ]+)(?=;?)/)[1] || "");
    i1Illi.includes(I1ili1) && i1Illl.push(lIiili[I1iliI]);
  }
  helpCookiesArr = i1Illl;
  if (i1Illi.length > 1) {
    for (let iIl1l1 in i1Illi) {
      let iIili1 = i1Illi[i1Illi.length - 1 - iIl1l1];
      if (!iIili1) {
        continue;
      }
      for (let Iil11l in helpCookiesArr) {
        let iI1iil = decodeURIComponent(helpCookiesArr[Iil11l].match(/pt_pin=([^; ]+)(?=;?)/) && helpCookiesArr[Iil11l].match(/pt_pin=([^; ]+)(?=;?)/)[1]);
        iIili1 == iI1iil && l1IIII(helpCookiesArr, Iil11l);
      }
    }
  }
}
